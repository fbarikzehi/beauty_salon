@model Beauty.Application.Modules.Personnel.ViewModel.PersonnelFinancialViewModel
@using Common.Crosscutting.Enum;

@using (Html.BeginForm("UpdateFinancial", "Personnel", FormMethod.Post, new { id = "financial_frm", autocomplete = "off" }))
{
    @Html.HiddenFor(x => x.PersonnelId)
    <input id="CooperationType_init" type="hidden" value="@Model.CooperationType">
    <div class="card">
        <div class="card-header">
            <h5 class="card-title">نوع پرداخت دستمزد در ازای انجام کار را مشخص کنید</h5>
        </div>
        <div class="card-content">
            <div class="card-body">
                <p class="form-text text-muted">
                    در صورتی که پرداخت درصدی باشد برای هر خدمت انتخاب شده برای پرسنل درصد و درصورتی که حقوقی باشد میزان حقوق ماهیانه مشخص شود
                </p>
                <ul class="list-unstyled mb-0">
                    <li class="d-inline-block mr-2">
                        <fieldset>
                            <div class="custom-control custom-radio">
                                <input type="radio"
                                       class="custom-control-input"
                                       id="Entity_CooperationType_0"
                                       name="CooperationType"
                                       value="@CooperationTypeEnum.Salary"
                                       onchange="cooperationType_changed(0)"
                                       @(Model.CooperationType == CooperationTypeEnum.Salary ? "checked" : "")>
                                <label class="custom-control-label" for="Entity_CooperationType_0">حقوقی</label>
                            </div>
                        </fieldset>
                    </li>
                    <li class="d-inline-block mr-2">
                        <fieldset>
                            <div class="custom-control custom-radio">
                                <input type="radio"
                                       class="custom-control-input"
                                       id="Entity_CooperationType_1"
                                       name="CooperationType"
                                       value="@CooperationTypeEnum.Percentage"
                                       onchange="cooperationType_changed(1)"
                                       @(Model.CooperationType == CooperationTypeEnum.Percentage ? "checked" : "")>
                                <label class="custom-control-label" for="Entity_CooperationType_1">درصدی</label>
                            </div>
                        </fieldset>
                    </li>
                    <li class="d-inline-block mr-2">
                        <fieldset>
                            <div class="custom-control custom-radio">
                                <input type="radio"
                                       class="custom-control-input"
                                       id="Entity_CooperationType_2"
                                       name="CooperationType"
                                       value="@CooperationTypeEnum.SalaryPercentage"
                                       onchange="cooperationType_changed(2)"
                                       @(Model.CooperationType == CooperationTypeEnum.SalaryPercentage ? "checked" : "")>
                                <label class="custom-control-label" for="Entity_CooperationType_2">حقوقی و درصدی</label>
                            </div>
                        </fieldset>
                    </li>
                </ul>
                <div id="service_salary_wrapper"></div>
                <div id="service_percent_wrapper" class="form-group row"></div>
                <div id="service_salary_percent_wrapper"></div>
            </div>
        </div>
    </div>
}

<script type="text/template" id="service_percent_template">
    <div class="col-lg-3 col-md-3 col-sm-12">
        <label>نام خدمت</label>
        <input name="Services[{{index}}].PersonnelServiceId" type="hidden" value="{{PersonnelServiceId}}">
        <input class="form-control" readonly="readonly" type="text" value="{{ServiceTitle}}">
    </div>
    <div class="col-lg-3 col-md-3 col-sm-12 border-right">
        <div class="form-group form-group-marginless">
            <label>درصد</label>
            <div class="input-group">
                <input class="form-control" name="Services[{{index}}].Percentage" id="Services[{{index}}].Percentage" type="number" value="{{PersonnelServicePercentage}}" min="0" max="100" aria-describedby="Services[{{index}}].Percentage_i">
                <div class="input-group-append">
                    <span class="input-group-text" id="Services[{{index}}].Percentage_i">

                    </span>
                </div>
            </div>
        </div>
    </div>
</script>

<script type="text/template" id="salary_template">
    <div class="form-group row">
        <div class="col-lg-4 col-md-9 col-sm-12">
            <label>میزان حقوق ماهیانه (تومان)</label>
            <input class="form-control" name="Salary" id="Salary" type="text" onfocus="salary_inputmask(this)" value="{{value}}">
        </div>
    </div>
</script>

<script type="text/template" id="salary_percent_template">
    <div class="row">
        <div class="col-3 col-lg-3 col-md-6 col-sm-12">
            <label>میزان حقوق ماهیانه (تومان)</label>
            <input class="form-control" name="Salary" id="Salary" type="text" onfocus="salary_inputmask(this)" value="{{salary}}">
        </div>
    </div>
    <hr />
    <div class="row">
        {{#servicePercentages}}
        <div class="col-lg-3 col-md-3 col-sm-12">
            <label>نام خدمت</label>
            <input name="Services[{{index}}].PersonnelServiceId" type="hidden" value="{{PersonnelServiceId}}">
            <input class="form-control" readonly="readonly" type="text" value="{{ServiceTitle}}">
        </div>
        <div class="col-lg-3 col-md-3 col-sm-12 border-right">
            <div class="form-group form-group-marginless">
                <label>درصد</label>
                <div class="input-group">
                    <input class="form-control" name="Services[{{index}}].Percentage" id="Services[{{index}}].Percentage" type="number" value="{{PersonnelServicePercentage}}" min="0" max="100" aria-describedby="Services[{{index}}].Percentage_i">
                    <div class="input-group-append">
                        <span class="input-group-text" id="Services[{{index}}].Percentage_i">

                        </span>
                    </div>
                </div>
            </div>
        </div>
        {{/servicePercentages}}
    </div>
</script>


<script>
    cooperationType_changed(@((int)Model.CooperationType));
</script>